(()=>{"use strict";var t={913:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default={mongodb:{connectionString:"mongodb://localhost:27017/ecommerce"}}},598:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,u){function a(t){try{i(n.next(t))}catch(t){u(t)}}function c(t){try{i(n.throw(t))}catch(t){u(t)}}function i(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,c)}i((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=u(r(272)),c=u(r(583)),i=function(){function t(){}return t.prototype.createCart=function(){return n(this,void 0,void 0,(function(){var t,e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,a.default.doc().create({timestamp:Date.now(),products:[]})];case 1:return t=r.sent(),console.log(t),[2,t];case 2:return e=r.sent(),console.log(e),[2,!1];case 3:return[2]}}))}))},t.prototype.addProduct=function(t,e){return n(this,void 0,void 0,(function(){var r,n,u;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),[4,a.default.doc(t).get()];case 1:return r=o.sent().data(),[4,c.default.doc(e).get()];case 2:return n=o.sent().data(),console.log("product",n),console.log("cart",r),r?n?[3,3]:[2,{msg:"No hemos podido encontrar el producto"}]:[2,{msg:"No hemos podido encontrar el carrito"}];case 3:return[4,a.default.doc(t).update({products:n})];case 4:return[2,o.sent()];case 5:return[3,7];case 6:return u=o.sent(),console.log(u),[2,!1];case 7:return[2]}}))}))},t.prototype.getAllProducts=function(t){return n(this,void 0,void 0,(function(){var t,e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,a.default.get()];case 1:return t=r.sent(),[2,t.docs.map((function(t){return{id:t.id,timestamp:t.data().timestamp,products:t.data().products}}))];case 2:return e=r.sent(),console.log(e),[2,[]];case 3:return[2]}}))}))},t.prototype.getCartById=function(t){return n(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,a.default.doc(t).get()];case 1:return[2,r.sent().data()];case 2:return e=r.sent(),console.log(e),[2,[]];case 3:return[2]}}))}))},t.prototype.deleteCart=function(t){return n(this,void 0,void 0,(function(){var e,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,a.default.doc("".concat(t)).delete()];case 1:return e=n.sent(),console.log("deletedcart",e),[2,e];case 2:return r=n.sent(),console.log(r),[2,!1];case 3:return[2]}}))}))},t.prototype.deleteProductById=function(t,e){return n(this,void 0,void 0,(function(){var r,n,u,i;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,10,,11]),[4,a.default.doc(t).get()];case 1:return r=o.sent().data(),[4,c.default.doc(e).get()];case 2:return n=o.sent().data(),r?n?r.products.length>0?(r.products.filter((function(t){return t.id!==e})),[4,a.default.doc(t).update({products:n})]):[3,4]:[3,6]:[3,8];case 3:return[2,o.sent()];case 4:throw(u=new Error("Cart does not have products to delete!")).status=400,u;case 5:return[3,7];case 6:throw(u=new Error("Product does not exist!")).status=400,u;case 7:return[3,9];case 8:throw(u=new Error("Cart does not exist!")).status=400,u;case 9:return[3,11];case 10:return i=o.sent(),console.log(i),[2,!1];case 11:return[2]}}))}))},t}();e.default=i},130:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,u){function a(t){try{i(n.next(t))}catch(t){u(t)}}function c(t){try{i(n.throw(t))}catch(t){u(t)}}function i(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,c)}i((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=u(r(583)),c=function(){function t(){}return t.prototype.addProduct=function(t){return n(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),console.log("entre al try del container"),[4,a.default.doc().create(t)];case 1:return[2,r.sent()];case 2:return e=r.sent(),console.log(e),[3,3];case 3:return[2]}}))}))},t.prototype.getAll=function(){return n(this,void 0,void 0,(function(){var t,e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,a.default.get()];case 1:return t=r.sent(),[2,t.docs.map((function(t){return{id:t.id,timestamp:t.data().timestamp,title:t.data().title,description:t.data().description,code:t.data().codigo,thumbnail:t.data().thumbnail,price:t.data().price,stock:t.data().stock}}))];case 2:return e=r.sent(),console.log(e),[2,[]];case 3:return[2]}}))}))},t.prototype.getById=function(t){return n(this,void 0,void 0,(function(){var e,r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,a.default.doc(t).get()];case 1:return e=o.sent(),r=e.data(),console.log(r),[2,r];case 2:return n=o.sent(),console.log(n),[2,!1];case 3:return[2]}}))}))},t.prototype.updateById=function(t,e,r){return n(this,void 0,void 0,(function(){var n,u;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r.name=e.name?e.name:r.name,r.description=e.description?e.description:r.description,r.code=e.code?e.code:r.code,r.thumbnail=e.thumbnail?e.thumbnail:r.thumbnail,r.price=e.price?Number(e.price):Number(r.price),r.stock=e.stock?Number(e.stock):Number(r.stock),[4,a.default.doc("".concat(t)).update({name:r.name,description:r.description,code:r.code,thumbnail:r.thumbnail,price:r.price,stock:r.stock})];case 1:return n=o.sent(),console.log(n),[2,n];case 2:return u=o.sent(),console.log(u),[2,!1];case 3:return[2]}}))}))},t.prototype.deleteById=function(t){return n(this,void 0,void 0,(function(){var e,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,a.default.doc("".concat(t)).delete()];case 1:return e=n.sent(),console.log(e),[2,!0];case 2:return r=n.sent(),console.log(r),[2,!1];case 3:return[2]}}))}))},t}();e.default=c},258:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,u){function a(t){try{i(n.next(t))}catch(t){u(t)}}function c(t){try{i(n.throw(t))}catch(t){u(t)}}function i(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,c)}i((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=u(r(117)),c=u(r(821)),i=function(){function t(){}return t.prototype.createCart=function(t){return n(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),console.log("entre al try del container"),[4,a.default.create({products:t.products})];case 1:return[2,r.sent()];case 2:return e=r.sent(),console.log(e),[2,!1];case 3:return[2]}}))}))},t.prototype.addProduct=function(t,e){return n(this,void 0,void 0,(function(){var n,u,i,s,l,d,f;return o(this,(function(o){switch(o.label){case 0:n=r(13).ObjectID,u=new n(t),i=new n(e),o.label=1;case 1:return o.trys.push([1,7,,8]),[4,a.default.findById({_id:u})];case 2:return s=o.sent(),[4,c.default.findById({_id:i})];case 3:return l=o.sent(),console.log("selectedCart",s),console.log("productToAdd",l),s&&l?[4,a.default.findOneAndUpdate({selectedCart:s},{$addToSet:{products:l}})]:[3,5];case 4:return d=o.sent(),console.log("updatedDocument",d),[3,6];case 5:console.log("Lo sentimos, no pudimos agregar el producto"),o.label=6;case 6:return[3,8];case 7:return f=o.sent(),console.log(f),[2,!1];case 8:return[2]}}))}))},t.prototype.getAllProducts=function(t){return n(this,void 0,void 0,(function(){var e,n,u;return o(this,(function(o){switch(o.label){case 0:e=r(13).ObjectID,n=new e(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a.default.find({_id:n}).populate({path:"products",select:"timestamp title description code thumbnail price stock"})];case 2:return[2,o.sent()];case 3:return u=o.sent(),console.log(u),[2,[]];case 4:return[2]}}))}))},t.prototype.getCartById=function(t){return n(this,void 0,void 0,(function(){var e,n,u;return o(this,(function(o){switch(o.label){case 0:e=r(13).ObjectID,n=new e(t),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,a.default.findById({_id:n}).populate({path:"products",select:"timestamp title description code thumbnail price stock"})];case 2:return[2,o.sent()];case 3:return u=o.sent(),console.log(u),[2,[]];case 4:return[2]}}))}))},t.prototype.deleteCartById=function(t){return n(this,void 0,void 0,(function(){var e,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,a.default.findByIdAndDelete(t)];case 1:return e=n.sent(),console.log(e),[2,!0];case 2:return r=n.sent(),console.log(r),[2,!1];case 3:return[2]}}))}))},t.prototype.deleteProductById=function(t,e){return n(this,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,a.default.findByIdAndUpdate(t,{$pull:{products:e}})];case 1:return[2,n.sent()];case 2:return r=n.sent(),console.log(r),[2,!1];case 3:return[2]}}))}))},t}();e.default=i},22:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,u){function a(t){try{i(n.next(t))}catch(t){u(t)}}function c(t){try{i(n.throw(t))}catch(t){u(t)}}function i(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,c)}i((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=u(r(913)),c=u(r(185)),i=u(r(821));!function(){n(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,c.default.connect(a.default.mongodb.connectionString)];case 1:return t=e.sent(),console.log(t),[3,3];case 2:return e.sent(),console.log("Fallo la conexion con mongoose"),[3,3];case 3:return[2]}}))}))}();var s=function(){function t(){}return t.prototype.addProduct=function(t){return n(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),console.log("entre al try del container"),[4,i.default.create({title:t.title,description:t.description,code:t.code,thumbnail:t.thumbnail,price:t.price,stock:t.stock})];case 1:return[2,r.sent()];case 2:return e=r.sent(),console.log(e),[3,3];case 3:return[2]}}))}))},t.prototype.getById=function(t){return n(this,void 0,void 0,(function(){var e,n;return o(this,(function(o){switch(o.label){case 0:return e=r(13).ObjectID,n=new e(t),[4,i.default.find({_id:n})];case 1:return[2,o.sent()]}}))}))},t.prototype.getProducts=function(){return n(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,i.default.find()];case 1:return[2,e.sent()];case 2:return t=e.sent(),console.log("No existen productos",t),[3,3];case 3:return[2]}}))}))},t.prototype.deleteById=function(t){return n(this,void 0,void 0,(function(){var e,n;return o(this,(function(o){switch(o.label){case 0:return e=r(13).ObjectID,n=new e(t),[4,i.default.deleteOne({_id:n})];case 1:return[2,o.sent()]}}))}))},t.prototype.updateProduct=function(t){return n(this,void 0,void 0,(function(){var e,n;return o(this,(function(o){switch(o.label){case 0:return e=r(13).ObjectID,n=new e(t),[4,i.default.updateOne({_id:n})];case 1:return[2,o.sent()]}}))}))},t}();e.default=s},526:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,u){function a(t){try{i(n.next(t))}catch(t){u(t)}}function c(t){try{i(n.throw(t))}catch(t){u(t)}}function i(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,c)}i((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.deleteProductFromCart=e.addProductToCart=e.getCartProducts=e.deleteCart=e.createCart=void 0;var u=r(971);e.createCart=function(t,e){return n(void 0,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,u.CartDao.createCart()];case 1:return r.sent(),e.status(201).send("Carrito creado con éxito"),[3,3];case 2:return t=r.sent(),console.log("Lo sentimos hubo un error ".concat(t)),[3,3];case 3:return[2]}}))}))},e.deleteCart=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=Number(t.params.id),[4,u.CartDao.deleteCart(r)];case 1:return o.sent()?e.status(200).send("Carrito eliminado"):e.status(503).send("No se pudo encontrar el carrito"),[3,3];case 2:return n=o.sent(),console.log("Lo sentimos hubo un error ".concat(n)),[3,3];case 3:return[2]}}))}))},e.addProductToCart=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,a,c;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=t.params.id,n=t.params.id_prod,[4,u.CartDao.addProduct(r,n)];case 1:return a=o.sent(),console.log(r),console.log(n),console.log(a),a?e.status(201).send("Producto agregado al carrito con éxito"):e.status(400).send("No se pudo encontrar el producto"),[3,3];case 2:return c=o.sent(),console.log("Lo sentimos hubo un error ".concat(c)),[3,3];case 3:return[2]}}))}))},e.getCartProducts=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,a;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=t.params.id,[4,u.CartDao.getAllProducts(r)];case 1:return n=o.sent(),console.log("cartProducts",n),n?e.status(200).send(n):e.status(400).send("Lo siento no pudimos encontrar el carrito con el id: ".concat(r)),[3,3];case 2:return a=o.sent(),console.log("Lo sentimos hubo un error ".concat(a)),[3,3];case 3:return[2]}}))}))},e.deleteProductFromCart=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,a;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=t.params.id,n=t.params.id_prod,[4,u.CartDao.deleteProductById(r,n)];case 1:return o.sent()?e.status(200).send("Producto del carrito eliminado con éxito"):e.status(400).send("Lo sentimos no pudimos encontrar el producto"),[3,3];case 2:return a=o.sent(),console.log("Lo sentimos hubo un error ".concat(a)),[3,3];case 3:return[2]}}))}))}},295:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,u){function a(t){try{i(n.next(t))}catch(t){u(t)}}function c(t){try{i(n.throw(t))}catch(t){u(t)}}function i(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,c)}i((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,u,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function c(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&u[0]?n.return:u[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,u[1])).done)return o;switch(n=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(t){u=[6,t],n=0}finally{r=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.deleteById=e.updateProduct=e.getById=e.addProductsController=e.getProducts=void 0;var u=r(971);e.getProducts=function(t,e){return n(void 0,void 0,void 0,(function(){var t,r;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,u.ProductDao.getAll()];case 1:return t=n.sent(),e.json(t),[3,3];case 2:return r=n.sent(),console.log("No existen productos",r),[3,3];case 3:return[2]}}))}))},e.addProductsController=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=t.body,console.log(u.ProductDao),[4,u.ProductDao.addProduct(r)];case 1:return n=o.sent(),console.log(n),n?e.status(201).json({msg:"El producto se creo de manera exitosa",data:n}):e.status(400).json("No se pudo agregar el producto"),[3,3];case 2:return o.sent(),console.log("Ocurrio un error al agregar el producto"),[3,3];case 3:return[2]}}))}))},e.getById=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return r=t.params.id,[4,u.ProductDao.getById(r)];case 1:return(n=o.sent())?e.send(n):e.status(404).json({error:"Producto no encontrado!"}),[2]}}))}))},e.updateProduct=function(t,e){return n(void 0,void 0,void 0,(function(){var r,n,a;return o(this,(function(o){switch(o.label){case 0:return r=t.params.id,n=t.body,[4,u.ProductDao.getById(r)];case 1:return(a=o.sent())?[4,u.ProductDao.updateById(r,n,a)]:[3,3];case 2:return o.sent(),e.json({msg:"El producto con el id ".concat(r," fue actualizado con exito")}),[3,4];case 3:e.status(404).json({error:"Producto no encontrado"}),o.label=4;case 4:return[2]}}))}))},e.deleteById=function(t,e){return n(void 0,void 0,void 0,(function(){var r;return o(this,(function(n){switch(n.label){case 0:return r=t.params.id,[4,u.ProductDao.deleteById(r)];case 1:return n.sent()?e.json("Producto eliminado"):e.status(404).json({error:"Producto no encontrado!"}),[2]}}))}))}},558:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return t.call(this)||this}return o(e,t),e}(u(r(598)).default);e.default=new a},34:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return t.call(this)||this}return o(e,t),e}(u(r(258)).default);e.default=new a},971:function(t,e,r){var n,o,u=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),c=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&u(e,t,r);return a(e,t),e},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};switch(Object.defineProperty(e,"__esModule",{value:!0}),e.CartDao=e.ProductDao=void 0,i(r(142)).default.config(),e.ProductDao=n,e.CartDao=o,process.env.DATABASE){case"firebase":Promise.resolve().then((function(){return c(r(928))})).then((function(t){return e.ProductDao=n=t.default})),Promise.resolve().then((function(){return c(r(558))})).then((function(t){return e.CartDao=o=t.default}));break;case"mongodb":Promise.resolve().then((function(){return c(r(500))})).then((function(t){return e.ProductDao=n=t.default})),Promise.resolve().then((function(){return c(r(34))})).then((function(t){return e.CartDao=o=t.default}));break;default:e.ProductDao=n=r(500),e.CartDao=o=r(34)}},928:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return t.call(this)||this}return o(e,t),e}(u(r(130)).default);e.default=new a},500:function(t,e,r){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return t.call(this)||this}return o(e,t),e}(u(r(22)).default);e.default=new a},457:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.db=void 0;var o=n(r(509)),u={type:"service_account",project_id:"nodeecommerce-ab326",private_key_id:process.env.FIREBASE_private_key_id,private_key:process.env.FIREBASE_private_key,client_email:"firebase-adminsdk-yz8l7@nodeecommerce-ab326.iam.gserviceaccount.com",client_id:"108572125430898665670",auth_uri:"https://accounts.google.com/o/oauth2/auth",token_uri:"https://oauth2.googleapis.com/token",auth_provider_x509_cert_url:"https://www.googleapis.com/oauth2/v1/certs",client_x509_cert_url:"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-yz8l7%40nodeecommerce-ab326.iam.gserviceaccount.com"};o.default.initializeApp({credential:o.default.credential.cert(u),databaseURL:"https://nodeecommerce-ab326.firebaseio.com"}),e.db=o.default.firestore(),console.log("Se ha establecido la conexion con Firebase"),e.default=o.default},912:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){return r()}},117:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(185)),u=o.default.Schema,a=new o.default.Schema({timestamp:{type:Date,default:Date.now()},products:[{type:u.Types.ObjectId,ref:"Product"}]});e.default=o.default.model("Cart",a)},272:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(457)).default.firestore().collection("carts");e.default=o},821:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(185)),u=new o.default.Schema({timestamp:{type:Date,default:Date.now()},title:{type:String,default:"No title"},description:{type:String,default:"No description"},code:{type:String,default:"No code"},thumbnail:{type:String,default:"No thumbnail"},price:{type:Number,default:1},stock:{type:Number,default:0}});e.default=o.default.model("Product",u)},583:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(457)).default.firestore().collection("products");e.default=o},479:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},o=r(295),u=r(526),a=r(860),c=n(r(912)),i=(0,a.Router)();i.get("/products",o.getProducts),i.get("/products/:id",o.getById),i.post("/products",c.default,o.addProductsController),i.put("/products/:id",c.default,o.updateProduct),i.delete("/products/:id",c.default,o.deleteById),i.post("/cart",u.createCart),i.delete("/cart/:id",u.deleteCart),i.get("/cart/:id/products",u.getCartProducts),i.post("/cart/:id/products/:id_prod",u.addProductToCart),i.delete("/cart/:id/products/:id_prod",u.deleteProductFromCart),t.exports=i},728:function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(860)),u=r(479);n(r(142)).default.config();var a=(0,o.default)();a.use(o.default.json()),a.use(o.default.urlencoded({extended:!0})),a.use("/api",u),a.use((function(t,e,r){var n={error:"-2",descripcion:"ruta: ".concat(t.url," método: ").concat(t.method," no implementado")};e.status(404).json(n),r()})),a.listen(4e3,(function(){return console.log("Server listening on port: ".concat(4e3))})).on("error",(function(t){return console.log("Oh no! Something is broken on the server: ".concat(t))}))},142:t=>{t.exports=require("dotenv")},860:t=>{t.exports=require("express")},509:t=>{t.exports=require("firebase-admin")},13:t=>{t.exports=require("mongodb")},185:t=>{t.exports=require("mongoose")}},e={};!function r(n){var o=e[n];if(void 0!==o)return o.exports;var u=e[n]={exports:{}};return t[n].call(u.exports,u,u.exports,r),u.exports}(728)})();